general:
  name: graph-tf-model
  wandb: disabled
  gpus:
  - 0
  resume: null
  check_val_every_n_epochs: 5
  sample_every_val: 4
  val_check_interval: null
  samples_to_generate: 512
  samples_to_save: 20
  chains_to_save: 1
  log_every_steps: 50
  number_chain_steps: 50
  final_model_samples_to_generate: 10000
  final_model_samples_to_save: 30
  final_model_chains_to_save: 20
  evaluate_all_checkpoints: false
model:
  type: discrete
  transition: marginal
  model: graph_tf
  diffusion_steps: 500
  diffusion_noise_schedule: cosine
  n_layers: 9
  extra_features: all
  hidden_mlp_dims:
    X: 256
    E: 128
    'y': 128
  hidden_dims:
    dx: 256
    de: 64
    dy: 64
    n_head: 8
    dim_ffX: 256
    dim_ffE: 128
    dim_ffy: 128
  lambda_train:
  - 5
  - 0
train:
  n_epochs: 1000
  batch_size: 512
  lr: 0.0002
  clip_grad: null
  save_model: true
  num_workers: 0
  ema_decay: 0
  progress_bar: false
  weight_decay: 1.0e-12
  optimizer: adamw
  seed: 0
dataset:
  name: qm9
  datadir: data/qm9/qm9_pyg/
  remove_h: true
  random_subset: null
  pin_memory: false
classifier:
  modelname: GIN
  num_hidden: 64
  num_layers: 2
  dropout: 0
  num_classes: 3
  train_lr: 0.0002
  weight_decay: 0.0005
  epochs: 100
  train_with_val: Train
  save_classifier: true
  load_classifier: true
  name: graph-tf-model
  resume: null
  guidance_target: both
  check_val_every_n_epochs: 5
  save_model: true
  clip_grad: null
  extra_features: null
  type: discrete
  trained_classifier_path: checkpoints/classifier_qm9.ckpt
reconstruct:
  num_reconstruct_per_class: 333
  sample_batch_size: 250
  sample_save_size: 20
  chains_save_size: 1
  extraction_mask_lr: 0.01
  extraction_mask_weight_decay: 0.0005
  extraction_lambda_lr: 0.1
  extraction_lambda_weight_decay: 0.0005
  extraction_min_lambda: 0.1
  X_lr: 0.1
  X_weight_decay: 0
  E_lr: 0.1
  E_weight_decay: 0
  num_recon_epoch: 80
